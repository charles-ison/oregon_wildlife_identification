import matplotlib.pyplot as plt
import seaborn as sns

def plot_run_times(data):
    fig, ax = plt.subplots()
    lineplot = sns.lineplot(data)
    lineplot.set(xlabel = "Training Epochs", ylabel = "Seconds")
    plt.legend(title='Number of GPUs')
    plt.show()

resnet34 = {"1": [23.029344081878662, 25.597619771957397,
                  28.178781509399414, 30.761257648468018,
                  33.3500394821167, 35.93318462371826,
                  38.50987911224365, 41.08901834487915,
                  43.66662526130676, 46.24378299713135],

            "2": [2.833008050918579, 4.214925050735474,
                  5.61467170715332, 7.009462118148804,
                  8.408639907836914, 9.811746597290039,
                  11.212854146957397, 12.619207620620728,
                  14.026312589645386, 15.420481204986572],

            "3": [3.5185658931732178, 4.734214544296265,
                  5.950875520706177, 7.177640199661255,
                  8.448723554611206, 9.70591402053833,
                  10.92150330543518, 12.194438219070435,
                  13.463373184204102, 14.76037073135376],

            "4": [4.204139947891235, 5.3487138748168945,
                  6.420765161514282, 7.488978147506714,
                  8.585782527923584, 9.660185813903809,
                  10.74204421043396, 11.787190198898315,
                  12.812959432601929, 13.869056940078735]
            }

plot_run_times(resnet34)

resnet50 = {"1": [5.477330684661865, 10.058862924575806,
                  14.669203281402588, 19.26672053337097,
                  23.862884283065796, 28.459263801574707,
                  33.062174797058105, 37.65943956375122,
                  42.2597291469574, 46.8621621131897],

            "2": [3.9095752239227295, 6.561851501464844,
                  8.989672899246216, 11.41309928894043,
                  13.842553853988647, 16.267948150634766,
                  18.698435306549072, 21.12205410003662,
                  23.55746102333069, 25.980286598205566],

            "3": [4.448009967803955, 6.392816781997681,
                  8.455591440200806, 10.552346467971802,
                  12.688644886016846, 14.868405103683472,
                  17.09285044670105, 19.347079277038574,
                  21.556042909622192, 23.759741067886353],

            "4": [4.981698274612427, 6.569239377975464,
                  8.246032238006592, 9.854969024658203,
                  11.552633285522461, 13.128346681594849,
                  14.765336990356445, 16.3961238861084,
                  17.999821424484253, 19.643191814422607]
            }

plot_run_times(resnet50)

resnet152 = {"1": [11.38500189781189, 21.856398105621338,
                   32.329041481018066, 42.81573009490967,
                   53.33455443382263, 63.80255603790283,
                   74.28920722007751, 84.75979161262512,
                   95.23792958259583, 105.7340018749237],

            "2": [7.028920650482178, 12.47068476676941,
                  17.928247690200806, 23.380625247955322,
                  28.83677864074707, 34.288864850997925,
                  39.74014115333557, 45.190852642059326,
                  50.6378698348999, 56.088621854782104],

            "3": [6.701848268508911, 11.011518955230713, 
                  15.401792049407959, 19.866190195083618,
                  24.430027961730957, 29.112225770950317,
                  33.775424003601074, 38.49897074699402,
                  43.27484154701233, 47.98402547836304],

            "4": [6.964935779571533, 10.308821201324463,
                  13.580735921859741, 16.93904948234558,
                  20.401914834976196, 23.86834192276001,
                  27.34510636329651, 30.88372039794922,
                  34.47911238670349, 38.11891293525696]
            }

plot_run_times(resnet152)

retina_net = {"1": [100.32027244567871, 199.53576683998108,
                    298.7652418613434, 397.98530316352844,
                    497.3745720386505, 596.5901825428009,
                    695.738094329834, 794.9240920543671,
                    894.0996267795563, 993.203871011734],

            "2": [52.927590131759644, 104.56585431098938,
                  156.23945689201355, 207.91239070892334,
                  259.9631962776184, 311.59994435310364,
                  363.19900035858154, 414.83237648010254,
                  466.4846556186676, 518.333179473877],

            "3": [44.01089024543762, 88.42941904067993,
                  131.58734273910522, 173.84412288665771,
                  217.481281042099, 261.35230588912964,
                  305.9956135749817, 350.355263710022,
                  394.4204261302948, 438.6436564922333],

            "4": [36.16781497001648, 70.86326241493225,
                  105.9741780757904, 140.98844647407532,
                  176.0457239151001, 210.70974969863892,
                  245.82170128822327, 281.2381064891815,
                  316.30705189704895, 351.38926815986633]
            }

plot_run_times(retina_net)
