2.0.1+cu117
0.15.2+cu117
torch.cuda.is_available(): True

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/cottonwood_eastface_2022/
loading annotations into memory...
Done (t=0.06s)
creating index...
index created!
Problematic image or label encountered, leaving out.
Problematic image or label encountered, leaving out.
Number of images found:  3479
Number of batches found:  596

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/ngilchrist_eastface_2022_MP180_13_ODOT05/
loading annotations into memory...
Done (t=0.02s)
creating index...
index created!
Number of images found:  190
Number of batches found:  46

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/crawford_westface_2022_MP150_ODOT006/
loading annotations into memory...
Done (t=0.07s)
creating index...
index created!
Number of images found:  3468
Number of batches found:  508

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/caltech/
loading annotations into memory...
Done (t=1.62s)
creating index...
index created!
Number of images found:  6055
Number of batches found:  762

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/vandevert_westface_2023_MP154_ODOT065/
loading annotations into memory...
Done (t=0.04s)
creating index...
index created!
Number of images found:  956
Number of batches found:  273

Number of training images:  11593
Number of validation images:  2555
Number of batches for training:  1745
Number of batches for validation:  440
Multiple GPUs available, using: 2

Training and Validating ResNet34
Epoch: 0
training loss: 0.0005870545383378572
validation MSE: 0.0005088562513984113, MAE: 0.0009160773394859001 and ACC: 0.9174168297455969
batch validation MSE: 0.20383659049929584, MAE: 0.20408506168221885 and ACC: 0.8954545454545455
Lowest batch validation MAE achieved, saving weights
R^2:  0.6025744853721753
Epoch: 1
training loss: 0.00011787943554535877
validation MSE: 0.00037268291276728335, MAE: 0.0007062714422985532 and ACC: 0.9405088062622309
batch validation MSE: 0.14851020276292956, MAE: 0.17604568694633516 and ACC: 0.925
Lowest batch validation MAE achieved, saving weights
R^2:  0.710445780267241
Epoch: 2
training loss: 6.957534172189079e-05
validation MSE: 0.0004195534436436782, MAE: 0.0009070601365337634 and ACC: 0.9272015655577299
batch validation MSE: 0.12845340997469146, MAE: 0.14642648119479418 and ACC: 0.925
Lowest batch validation MAE achieved, saving weights
R^2:  0.7495510387744605
Epoch: 3
training loss: 4.725024211927792e-05
validation MSE: 0.00036265148021237027, MAE: 0.0007342176544689619 and ACC: 0.9397260273972603
batch validation MSE: 0.13523990459156104, MAE: 0.14552062574604696 and ACC: 0.9272727272727272
Lowest batch validation MAE achieved, saving weights
R^2:  0.7363192336435633
Epoch: 4
training loss: 4.0478343086218046e-05
validation MSE: 0.0003738869922035128, MAE: 0.0006736521793204977 and ACC: 0.9385518590998043
batch validation MSE: 0.14147726378155856, MAE: 0.14245478217913346 and ACC: 0.9227272727272727
Lowest batch validation MAE achieved, saving weights
R^2:  0.7241580852536849
Epoch: 5
training loss: 3.393342195742779e-05
validation MSE: 0.000363719619358589, MAE: 0.0006888533729163168 and ACC: 0.9377690802348336
batch validation MSE: 0.14240590395261743, MAE: 0.15626645320179788 and ACC: 0.9136363636363637
Epoch: 6
training loss: 2.2083636169873496e-05
validation MSE: 0.0003310865924899592, MAE: 0.0006060590016165358 and ACC: 0.9409001956947163
batch validation MSE: 0.12912989830465085, MAE: 0.15093760147098112 and ACC: 0.9295454545454546
Epoch: 7
training loss: 2.238842054017715e-05
validation MSE: 0.0003123033901133416, MAE: 0.0005945155736051661 and ACC: 0.9475538160469668
batch validation MSE: 0.1194803933437662, MAE: 0.13541626356203448 and ACC: 0.9363636363636364
Lowest batch validation MAE achieved, saving weights
R^2:  0.7670459562783255
Epoch: 8
training loss: 1.8836706822127023e-05
validation MSE: 0.0003452860883304051, MAE: 0.0007512561729042964 and ACC: 0.9416829745596869
batch validation MSE: 0.13780421024646744, MAE: 0.18957452619956297 and ACC: 0.9295454545454546
Epoch: 9
training loss: 1.9053396716891284e-05
validation MSE: 0.0003144431779062678, MAE: 0.0005747796154768733 and ACC: 0.9424657534246575
batch validation MSE: 0.12039627242571901, MAE: 0.15317712750455195 and ACC: 0.9318181818181818

Training and Validating ResNet50
Epoch: 0
training loss: 0.0002615870585759741
validation MSE: 0.0004864609302723244, MAE: 0.0007815405872236726 and ACC: 0.9326810176125244
batch validation MSE: 0.20587897762044866, MAE: 0.18209782535506583 and ACC: 0.925
Lowest batch validation MAE achieved, saving weights
R^2:  0.59859239281084
Epoch: 1
training loss: 9.0350289965243e-05
validation MSE: 0.00042763216942257146, MAE: 0.0008397369118819265 and ACC: 0.9275929549902152
batch validation MSE: 0.15950382261835563, MAE: 0.21754717368166893 and ACC: 0.8931818181818182
Epoch: 2
training loss: 4.8349394878253814e-05
validation MSE: 0.00048493054748281343, MAE: 0.0008312085311706752 and ACC: 0.9185909980430529
batch validation MSE: 0.16044211115830923, MAE: 0.1888349673541432 and ACC: 0.9045454545454545
Epoch: 3
training loss: 3.314866013741391e-05
validation MSE: 0.0003980245754676789, MAE: 0.0007277736079436226 and ACC: 0.9338551859099804
batch validation MSE: 0.1455708749356218, MAE: 0.1637921187137677 and ACC: 0.925
Lowest batch validation MAE achieved, saving weights
R^2:  0.7161766726543867
Epoch: 4
training loss: 2.4843389477831753e-05
validation MSE: 0.00040950703994168693, MAE: 0.0007450328531097293 and ACC: 0.9350293542074364
batch validation MSE: 0.15586084998982577, MAE: 0.1720738540107215 and ACC: 0.9204545454545454
Epoch: 5
training loss: 1.924847931336243e-05
validation MSE: 0.0004317435222712515, MAE: 0.0008112116977426637 and ACC: 0.9240704500978474
batch validation MSE: 0.14737026607242143, MAE: 0.1869562937666408 and ACC: 0.9045454545454545
Epoch: 6
training loss: 1.6398262794886385e-05
validation MSE: 0.0003871757588157915, MAE: 0.0006891891506086823 and ACC: 0.9377690802348336
batch validation MSE: 0.14850626131350825, MAE: 0.15849505979567766 and ACC: 0.925
Lowest batch validation MAE achieved, saving weights
R^2:  0.7104534611038814
Epoch: 7
training loss: 1.3229279173734909e-05
validation MSE: 0.00038850745897003815, MAE: 0.0006901236983661316 and ACC: 0.9354207436399217
batch validation MSE: 0.1512731923111364, MAE: 0.15732869523450393 and ACC: 0.9227272727272727
Lowest batch validation MAE achieved, saving weights
R^2:  0.7050587037840559
Epoch: 8
training loss: 1.0431216026548762e-05
validation MSE: 0.00037081459438730827, MAE: 0.0006707104043251381 and ACC: 0.9362035225048924
batch validation MSE: 0.1401562670955091, MAE: 0.15242463866968387 and ACC: 0.9204545454545454
Lowest batch validation MAE achieved, saving weights
R^2:  0.726733676700534
Epoch: 9
training loss: 9.721155050595058e-06
validation MSE: 0.000378515133944043, MAE: 0.000665115826050596 and ACC: 0.9385518590998043
batch validation MSE: 0.1460543995544368, MAE: 0.14978762013329702 and ACC: 0.925
Lowest batch validation MAE achieved, saving weights
R^2:  0.7152339246322437

Training and Validating ResNet152
Epoch: 0
training loss: 0.0002930926982135694
