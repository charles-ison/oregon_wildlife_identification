2.0.1+cu117
0.15.2+cu117
torch.cuda.is_available(): True

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/cottonwood_eastface_2022/
loading annotations into memory...
Done (t=0.02s)
creating index...
index created!
Problematic image or label encountered, leaving out.
Problematic image or label encountered, leaving out.
Number of images found:  3479
Number of batches found:  596

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/ngilchrist_eastface_2022_MP180_13_ODOT05/
loading annotations into memory...
Done (t=0.01s)
creating index...
index created!
Number of images found:  190
Number of batches found:  46

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/crawford_westface_2022_MP150_ODOT006/
loading annotations into memory...
Done (t=0.02s)
creating index...
index created!
Number of images found:  3468
Number of batches found:  508

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/caltech/
loading annotations into memory...
Done (t=0.59s)
creating index...
index created!
Number of images found:  6055
Number of batches found:  762

Feting data from directory:  /nfs/stak/users/isonc/hpc-share/saved_data/training_animal_count/vandevert_westface_2023_MP154_ODOT065/
loading annotations into memory...
Done (t=0.01s)
creating index...
index created!
Number of images found:  956
Number of batches found:  273

Number of training images:  11352
Number of validation images:  2796
Number of batches for training:  1745
Number of batches for validation:  440
Multiple GPUs available, using: 2

Training and Validating ResNet34
Epoch: 0
training loss: 0.0005975981513523956
validation MSE: 0.0009881715551391776, MAE: 0.0018831081368636676 and ACC: 0.920958512160229
batch validation MSE: 0.17122970902060444, MAE: 0.2184976704757322 and ACC: 0.8863636363636364
Lowest batch validation MAE achieved, saving weights
R^2:  0.6925994844025246
Epoch: 1
training loss: 0.00021817296576194617
validation MSE: 0.0010919720174289056, MAE: 0.0016898281595140738 and ACC: 0.9062947067238912
batch validation MSE: 0.13849700392997902, MAE: 0.19441124418411743 and ACC: 0.8909090909090909
Lowest batch validation MAE achieved, saving weights
R^2:  0.7513629472476455
Epoch: 2
training loss: 0.00015120174770405577
validation MSE: 0.0009782848671846124, MAE: 0.0020217671190976075 and ACC: 0.9173819742489271
batch validation MSE: 0.14799035447151293, MAE: 0.2471494371685284 and ACC: 0.9045454545454545
Epoch: 3
training loss: 0.00010663648042844253
validation MSE: 0.0008539810273076843, MAE: 0.0014696036983755695 and ACC: 0.9263233190271817
batch validation MSE: 0.1333403417580499, MAE: 0.16785803329495882 and ACC: 0.9159090909090909
Lowest batch validation MAE achieved, saving weights
R^2:  0.7606204580055376
Epoch: 4
training loss: 8.342654596954464e-05
validation MSE: 0.0007669861110004574, MAE: 0.0015057425956656152 and ACC: 0.9295422031473534
batch validation MSE: 0.11410833675307418, MAE: 0.14952166261024435 and ACC: 0.9136363636363637
Lowest batch validation MAE achieved, saving weights
R^2:  0.7951467529732744
Epoch: 5
training loss: 6.539786537309126e-05
validation MSE: 0.0007921992581289726, MAE: 0.0018003167523249707 and ACC: 0.9384835479256081
batch validation MSE: 0.12072600035948204, MAE: 0.1492802738317881 and ACC: 0.9113636363636364
Lowest batch validation MAE achieved, saving weights
R^2:  0.7832663810304956
Epoch: 6
training loss: 6.026590881543332e-05
validation MSE: 0.000770232789431604, MAE: 0.001333358770873243 and ACC: 0.9366952789699571
batch validation MSE: 0.12441228903115509, MAE: 0.15077166845863263 and ACC: 0.9181818181818182
Epoch: 7
training loss: 4.677180483403345e-05
validation MSE: 0.0007402650826745194, MAE: 0.0012644776842624845 and ACC: 0.9370529327610873
batch validation MSE: 0.1171275408035864, MAE: 0.1503842345618812 and ACC: 0.9159090909090909
Epoch: 8
training loss: 3.313487794770714e-05
validation MSE: 0.0006786398076650837, MAE: 0.0011555879844488504 and ACC: 0.9413447782546495
batch validation MSE: 0.11075393491092585, MAE: 0.1373559276626276 and ACC: 0.9204545454545454
Lowest batch validation MAE achieved, saving weights
R^2:  0.8011687530296352
Epoch: 9
training loss: 3.366304428467279e-05
validation MSE: 0.0008129711024388564, MAE: 0.0013467549467632528 and ACC: 0.9345493562231759
batch validation MSE: 0.12971407770842402, MAE: 0.1410960096040402 and ACC: 0.9159090909090909

Training and Validating ResNet50
Epoch: 0
training loss: 0.00047514957946497444
validation MSE: 0.0009846768837598005, MAE: 0.001490868990428117 and ACC: 0.9263233190271817
batch validation MSE: 0.21318130025608029, MAE: 0.19274302448929204 and ACC: 0.9090909090909091
Lowest batch validation MAE achieved, saving weights
R^2:  0.6172858011056181
Epoch: 1
training loss: 0.00018953832670871675
validation MSE: 0.001007978918992825, MAE: 0.0016306499112530668 and ACC: 0.9306151645207439
batch validation MSE: 0.18113438846340565, MAE: 0.17562183696268635 and ACC: 0.9204545454545454
Lowest batch validation MAE achieved, saving weights
R^2:  0.6748180791081131
Epoch: 2
training loss: 0.00011639351384888828
validation MSE: 0.0007878460099278431, MAE: 0.0015519535880487876 and ACC: 0.9273962804005722
batch validation MSE: 0.11733392087369798, MAE: 0.1954809708563103 and ACC: 0.9
Epoch: 3
training loss: 8.307423690282113e-05
validation MSE: 0.0007889160249536811, MAE: 0.0013218357311681615 and ACC: 0.9341917024320457
batch validation MSE: 0.1370116235576288, MAE: 0.17408013066319242 and ACC: 0.9159090909090909
Lowest batch validation MAE achieved, saving weights
R^2:  0.7540295788441653
Epoch: 4
training loss: 5.9119404691164505e-05
validation MSE: 0.0007532762646014257, MAE: 0.001269625606433687 and ACC: 0.9359799713876967
batch validation MSE: 0.12039555087790384, MAE: 0.16195582718673077 and ACC: 0.9181818181818182
Lowest batch validation MAE achieved, saving weights
R^2:  0.7838596206787216
Epoch: 5
training loss: 4.371733685602303e-05
validation MSE: 0.0007448671725398737, MAE: 0.0012723290853106414 and ACC: 0.9356223175965666
batch validation MSE: 0.1330703496796346, MAE: 0.17010180335068567 and ACC: 0.9204545454545454
Epoch: 6
training loss: 3.817936769101527e-05
validation MSE: 0.0007194962894786495, MAE: 0.0012030257911385385 and ACC: 0.9370529327610873
batch validation MSE: 0.11663815445573199, MAE: 0.15183913198257373 and ACC: 0.9227272727272727
Lowest batch validation MAE achieved, saving weights
R^2:  0.790605092938315
Epoch: 7
training loss: 2.9446297029479276e-05
validation MSE: 0.0006713219185510333, MAE: 0.0012304064323419494 and ACC: 0.9381258941344778
batch validation MSE: 0.11372769856426197, MAE: 0.16586714890912513 and ACC: 0.9227272727272727
Epoch: 8
training loss: 2.60977710501558e-05
validation MSE: 0.000681768649807986, MAE: 0.0012383716119631848 and ACC: 0.932761087267525
batch validation MSE: 0.10103200030394562, MAE: 0.15071888915368947 and ACC: 0.925
Lowest batch validation MAE achieved, saving weights
R^2:  0.8186220769318389
Epoch: 9
training loss: 2.498726604652077e-05
validation MSE: 0.000667840797981735, MAE: 0.001193072236488135 and ACC: 0.9374105865522174
batch validation MSE: 0.10628165604617802, MAE: 0.15181517510844225 and ACC: 0.9204545454545454

Training and Validating ResNet152
Epoch: 0
training loss: 0.0004749678320942514
validation MSE: 0.000926141609812158, MAE: 0.0015622305314726755 and ACC: 0.9238197424892703
batch validation MSE: 0.18500246865060035, MAE: 0.201325608398342 and ACC: 0.9068181818181819
Lowest batch validation MAE achieved, saving weights
R^2:  0.6678739117048723
Epoch: 1
training loss: 0.00017633205409331735
validation MSE: 0.00076507573323764, MAE: 0.0013602555906653234 and ACC: 0.9298998569384835
batch validation MSE: 0.12426734301751104, MAE: 0.17547016235872764 and ACC: 0.9113636363636364
Lowest batch validation MAE achieved, saving weights
R^2:  0.7769087744417733
Epoch: 2
training loss: 0.00010319226659743156
validation MSE: 0.0007458750967293423, MAE: 0.001351837311286442 and ACC: 0.932761087267525
batch validation MSE: 0.12306680760197802, MAE: 0.17031006354161285 and ACC: 0.9068181818181819
Lowest batch validation MAE achieved, saving weights
R^2:  0.7790640387808723
Epoch: 3
training loss: 7.702943329847666e-05
validation MSE: 0.0006957721079730339, MAE: 0.001245362404334187 and ACC: 0.9424177396280401
batch validation MSE: 0.1036802938907575, MAE: 0.1498455686240711 and ACC: 0.9204545454545454
Lowest batch validation MAE achieved, saving weights
R^2:  0.8138677201295221
Epoch: 4
training loss: 5.665993757657195e-05
validation MSE: 0.0007054820231752249, MAE: 0.001189484587405543 and ACC: 0.9420600858369099
batch validation MSE: 0.1496905038922674, MAE: 0.15747699260881 and ACC: 0.9113636363636364
Epoch: 5
training loss: 4.701456040688058e-05
validation MSE: 0.0006827478835329904, MAE: 0.0011462277582232362 and ACC: 0.9384835479256081
batch validation MSE: 0.10948223667345106, MAE: 0.14313509802715005 and ACC: 0.9181818181818182
Lowest batch validation MAE achieved, saving weights
R^2:  0.803451769422368
Epoch: 6
training loss: 3.361748440703574e-05
validation MSE: 0.0006292311298808826, MAE: 0.0011621477463427871 and ACC: 0.9395565092989986
batch validation MSE: 0.09999776733966945, MAE: 0.1471297857944261 and ACC: 0.925
Epoch: 7
training loss: 3.6167516781248865e-05
validation MSE: 0.0006954413405666195, MAE: 0.001180841359649605 and ACC: 0.9356223175965666
batch validation MSE: 0.09736562771445914, MAE: 0.14221901834561404 and ACC: 0.9181818181818182
Lowest batch validation MAE achieved, saving weights
R^2:  0.8252041411799372
Epoch: 8
training loss: 3.43090974405169e-05
validation MSE: 0.0006801121467151526, MAE: 0.0011243608184638453 and ACC: 0.9409871244635193
batch validation MSE: 0.10850577089605286, MAE: 0.13322423397648064 and ACC: 0.9272727272727272
Lowest batch validation MAE achieved, saving weights
R^2:  0.8052047737873813
Epoch: 9
training loss: 3.0164177069841497e-05
validation MSE: 0.0006523750348013954, MAE: 0.001174010152532819 and ACC: 0.944206008583691
batch validation MSE: 0.11795773715790293, MAE: 0.15134176330810242 and ACC: 0.9181818181818182

Training and Validating RetinaNet
Epoch: 0
training loss: 0.03547273316536127
validation MSE: 0.037672866439614684, MAE: 0.027324750236047697 and ACC: 0.7675250357653791
batch validation MSE: 0.6272727272727273, MAE: 0.3181818181818182 and ACC: 0.7886363636363637
Lowest batch validation MAE achieved, saving weights
R^2:  -0.12611275964391688
Epoch: 1
training loss: 0.021519529835535626
validation MSE: 0.029434907424646044, MAE: 0.022711016157793897 and ACC: 0.8011444921316166
batch validation MSE: 0.3931818181818182, MAE: 0.22045454545454546 and ACC: 0.8363636363636363
Lowest batch validation MAE achieved, saving weights
R^2:  0.2941394658753709
Epoch: 2
training loss: 0.01746237391659792
validation MSE: 0.030543633983157393, MAE: 0.018812589747071777 and ACC: 0.8494277539341917
batch validation MSE: 0.5772727272727273, MAE: 0.24545454545454545 and ACC: 0.8522727272727273
Epoch: 3
training loss: 0.016148253562252475
validation MSE: 0.03142584676991546, MAE: 0.019265617871489137 and ACC: 0.8490701001430615
batch validation MSE: 0.5545454545454546, MAE: 0.2590909090909091 and ACC: 0.8363636363636363
Epoch: 4
training loss: 0.013265440306293627
validation MSE: 0.021459227774254925, MAE: 0.01623748246319219 and ACC: 0.8594420600858369
batch validation MSE: 0.3159090909090909, MAE: 0.20227272727272727 and ACC: 0.8409090909090909
Lowest batch validation MAE achieved, saving weights
R^2:  0.4328635014836796
Epoch: 5
training loss: 0.013163806132216157
validation MSE: 0.01691702457787056, MAE: 0.013412017468496283 and ACC: 0.880901287553648
batch validation MSE: 0.29318181818181815, MAE: 0.19318181818181818 and ACC: 0.8454545454545455
Lowest batch validation MAE achieved, saving weights
R^2:  0.4736646884272997
Epoch: 6
training loss: 0.0105409474461524
validation MSE: 0.014651883883836102, MAE: 0.011719122811491057 and ACC: 0.8952074391988555
batch validation MSE: 0.20454545454545456, MAE: 0.12727272727272726 and ACC: 0.9
Lowest batch validation MAE achieved, saving weights
R^2:  0.6327893175074184
Epoch: 7
training loss: 0.009873504243626038
validation MSE: 0.013912732682280105, MAE: 0.011766809951487359 and ACC: 0.8916309012875536
batch validation MSE: 0.15, MAE: 0.10909090909090909 and ACC: 0.9068181818181819
Lowest batch validation MAE achieved, saving weights
R^2:  0.7307121661721068
Epoch: 8
training loss: 0.009047987040541173
validation MSE: 0.012911302062852018, MAE: 0.010979971599276144 and ACC: 0.8994992846924177
batch validation MSE: 0.19772727272727272, MAE: 0.15227272727272728 and ACC: 0.8681818181818182
Epoch: 9
training loss: 0.009452661587082248
validation MSE: 0.010228898592069425, MAE: 0.008798283427548681 and ACC: 0.9188125894134478
batch validation MSE: 0.12954545454545455, MAE: 0.09772727272727273 and ACC: 0.9159090909090909
Lowest batch validation MAE achieved, saving weights
R^2:  0.767433234421365
